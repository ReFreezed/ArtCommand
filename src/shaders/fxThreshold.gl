/***************************************************************
*
*  Effect: Threshold
*
*---------------------------------------------------------------
*
*  Art Command
*  by Marcus 'ReFreezed' Thunstr√∂m
*
***************************************************************/

#include "_colorSpaces"

uniform float threshold;
uniform bool  alphaMode;

#define P z

vec4 effect(vec4 loveColor, Image tex, vec2 texUv, vec2 screenPos) {
	vec4 color  = Texel(tex, texUv);
	color.rgb  /= color.a;

	if (alphaMode)  color.a   =      (color.a            < threshold) ? 0 : 1 ;
	else            color.rgb = vec3((toHsp(color.rgb).P < threshold) ? 0 : 1);

	color.rgb *= color.a;
	return color;
}
